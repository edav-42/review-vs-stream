---
output: html_document
---

# Results

In the part of data exploratory analysis, we will first introduce the respective data of Metacritic Ratings and Rate Your Music Ratings in turn, then compare and analyze ratings from Metacritic and RYM. Next we will introduce Spotify Popularity and Tracks Variables, and finally we will cross-analyze data from these three data source.

**Note**: For reading convenience, the following plots whose feature are filled in purple denotes that the main data is from Metacritic, blue for RYM and green for Spotify. Orange represents cross-analysis. :)

```{r, echo=FALSE}
library(ggplot2)
library(ggExtra)
library(ggpubr)
library(dplyr)
library(forcats)
library(stringr)
library(Rmisc)
library(GGally)
library(ggcorrplot)
library(plotly)
df = read.csv("data/data.csv")

mt = read.csv("data/meta.csv")
rym = read.csv("data/rym.csv")
rym$Released <- as.Date(rym$Released , format = "%d %B %Y")
df$Release_Date = as.Date(df$Release_Date)

sptf = read.csv("data/spotify.csv")
sptf_tk = read.csv("data/spotify_tracks.csv")
```

## Metacritic

What's the distribution of critic ratings of Albums that were released between 2018 and 2022 on Metacritic look like? How does it change over time? The following graph tells us the answer.

First, from the marginal density graph in the right part of the graph, we can tell that the  distribution of critic ratings is a little bit **left skewed**. Most albums' ratings are within the range [70,90]. There are, however, a few albums with really low ratings. For example, one album's rating on Metacritic doesn't even reach 40 out of 100.

Second, the top density curve of the graph tells us how the number of ratings of albums on Metacritic changes over time. We can see that the number of ratings is **steadily decrease** over time. Since every album only has one score on Metacritic, it could be that the phenomenon that the number of albums released is decreased over time leads to the decline.

Lastly, the purple dot in the graph shows the album ratings on Metacritic and corresponding release time. At first glance, there is no obvious pattern or trend in it: points are roughly evenly distributed, and there is no sudden change along the release date. However, there is a small interesting finding: it seems that there exists **invisible line** that separate the points between different year. It is weird at first because we didn't make any restriction on the date. However, after second thought, it is quite reasonable, artists also celebrate Christmas and New Year! So at the end of each year, there are basically no new albums released.

```{r}
ggscatterhist(df, x = 'Release_Date', y = 'Metacritic_Score', color = "purple2",size = 0.1, alpha = 0.8,
              margin.params = list(fill = "lightgray"), xlab = "Album Release Date", ylab = "Album Score on Metacritic", title = "Album Score on Metacritic")
```


## RYM

The three pattern also exist in the below plot for RYM ratings. However, the **variance** of user ratings are much larger than critic reviews. Why? The lowest rating in Metacritic is around 40 while in RYM, it is below 1. Considering that the critic ratings range from 0 to 100 and user ratings range from 0 to 5, 40 in 100 is a much tender rating compared to 1 in 5. We can also observe that the number of score is decline over time and also there are invisible lines between years.

```{r}
ggscatterhist(df, x = 'Release_Date', y = 'RYM_Rating', color = "blue3", size = 0.1, alpha = 0.8,
              margin.params = list(fill = "lightgray"), xlab = "Album Release Date", ylab = "Album Score on RYM", title = "Album Score on RYM")
```

Next, we will analysis relationship between the number of users who rate the album and the album ratings through an **interactive scatter plot**. You can *hover* over the point and it will show you the name of the album you point at. You can also select a rectangle to see the partial data and dive deeper. 

The point are colored according to the Metacritic score, the deeper of the color means the higher the score is. Along the y-axis, we can see that roughly the color of the points turns deeper, which means overall the RYM ratings and Metacritic Score have positive relationships.(We will discuss the relationship later)

Regarding the relationship between the number of users who rate the album and the album ratings, we have following findings:
- There is no albums with *high votes and low ratings*. It is reasonable because people have more incentive to rate an album if they think it is great, otherwise they will just omit it. There is an exception on the album **"Jesus Is King"** by Kanye West with 27k votes and 2.38 rating. Maybe we should all listen to this album thouroughly to find out why:)

- For albums with more than a few votes, the average rating increases with the number of votes.
- No albums in the area where represents high votes and max ratings
- There are points who are lower than expected ratings and should be seen as **outliers.** (e.g. "Jesus Is King")
- Albums with low votes have relatively full range over y-axis.

```{r}
fig <- plot_ly(df, x = ~Num_of_RYM_Ratings, y = ~RYM_Rating, text = ~ Album_Name, color = ~Metacritic_Score, type = 'scatter', mode = 'markers', colors = 'YlOrBr',
        sizes = c(10, 50),
        marker = list(opacity = 0.9, sizemode = 'diameter'))
fig <- fig %>% layout(title = 'Album Score on RYM',
         xaxis = list(showgrid = FALSE),
         yaxis = list(showgrid = FALSE),
         showlegend = TRUE)

fig
```

## Metacritic VS RYM

In this part we will compare between metacritic ratings and RYM ratings.


```{r}

mt = ggplot(df, aes(Release_Date, Metacritic_Score)) + 
  geom_point(size = 0.02, alpha = 0.5) + 
  labs(x = "Album Release Date", y = "Album Score on Metacritic") +
  ggtitle("Album Score on Metacritic")

mt_d = ggplot(df, aes(x=factor(Release_Year),y=Metacritic_Score)) +
  geom_boxplot(fill = "purple2", alpha=0.3) +
  ggtitle("Album Score on Metacritic") +
  labs(y="Release Year", x="Album Score on Metacritic")

rym = ggplot(df, aes(Release_Date, RYM_Rating)) + 
  geom_point(size = 0.02, alpha = 0.5) + 
  labs(x = "Album Release Date", y = "Album Score on RYM") +
  theme(axis.text.x = element_blank())+ 
  ggtitle("Album Score on RYM")

rym_d = ggplot(df, aes(x=factor(Release_Year),y=RYM_Rating)) +
  geom_boxplot(fill = "blue3", alpha=0.3) +
  ggtitle("Album Score on RYM") +
  labs(y="Release Year", x="Album Score on RYM")

multiplot(mt_d,rym_d,cols = 2)
```

```{r}

rym_singer <- df %>%
  group_by(Singer) %>%
  summarise_at(vars(RYM_Rating), list(rym_score = mean))
rym_singer <- rym_singer[order(-rym_singer$rym_score),][1:15,]

rym_singer = rym_singer %>%
  ggplot(aes(x = rym_score, y = fct_reorder(Singer, rym_score))) +
  geom_point(color = "blue3") +
  ggtitle("RYM\nTop 15 Artists\n(2018-2022)") +
  theme(plot.title = element_text(size = 1, face = "bold"))+
  ylab("") +
  xlab("RYM score") +
  theme_linedraw()

mt_singer <- df %>%
  group_by(Singer) %>%
  summarise_at(vars(Metacritic_Score), list(mt_score = mean))
mt_singer <- mt_singer[order(-mt_singer$mt_score),][1:15,]


mt_singer = mt_singer %>%
  ggplot(aes(x = mt_score, y = fct_reorder(Singer, mt_score))) +
  geom_point(color = "purple2") +
  ggtitle("Metacritic\nTop 15 Artists\n(2018-2022)") +
  theme(plot.title = element_text(size = 1, face = "bold"))+
  ylab("") +
  xlab("metacritic score") +
  theme_linedraw()

multiplot(mt_singer,rym_singer,cols = 2)
```

```{r}
ggplot(df, aes(Metacritic_Score, RYM_Rating)) + 
  geom_point(size = 0.03, alpha = 0.5) + 
  geom_smooth(colour = "coral") +
  labs(x = "Metacritic Score", y = "Rate Your Music Score") +
  ggtitle("Metacritic vs Rate Your music")
```

```{r}
df$Fct_Release_Year = as.character(df$Release_Year)

ggplot(df, aes(Metacritic_Score, RYM_Rating, colour = Fct_Release_Year)) + 
  geom_point(size = 0.03, alpha = 0.5) + 
  geom_smooth() +
  facet_wrap(~Fct_Release_Year)+
  labs(x = "Metacritic Score", y = "Rate Your Music Score") +
  ggtitle("Metacritic vs Rate Your music")
```

## Spotify

```{r}
ggscatterhist(df, x = 'Release_Date', y = 'max_pop', color = "darkgreen",size = 0.1, alpha = 0.8,
              margin.params = list(fill = "lightgray"), xlab = "Album Release Date", ylab = "Spotify Popularity(max in an album)", title = "Spotify Popularity")

```

```{r}

max = ggplot(df, aes(x=factor(Release_Year),y=max_pop)) +
  geom_boxplot(fill = "darkgreen", alpha=0.3) +
  ggtitle("Spotify Popularity(Maximum of Album)") +
  labs(x="Release Year", y="Spotify Popularity(max)")
avg = ggplot(df, aes(x=factor(Release_Year),y=avg_pop)) +
  geom_boxplot(fill = "darkgreen", alpha=0.3) +
  ggtitle("Spotify Popularity(Average of Album)") +
  labs(x="Release Year", y="Spotify Popularity(avg)")
min = ggplot(df, aes(x=factor(Release_Year),y=min_pop)) +
  geom_boxplot(fill = "darkgreen", alpha=0.3) +
  ggtitle("Spotify Popularity(Min of Album)") +
  labs(x="Release Year", y="Spotify Popularity(min)")
med = ggplot(df, aes(x=factor(Release_Year),y=med_pop)) +
  geom_boxplot(fill = "darkgreen", alpha=0.3) +
  ggtitle("Spotify Popularity(Median of Album)") +
  labs(x="Release Year", y="Spotify Popularity(med)")

multiplot(max,avg,min,med ,cols = 2)
```

```{r}
ggparcoord(df, columns = c(16, 17,18,19), alpha=0.08,
           title = "Parallel coordinate plot for Album Popularity()",
           scale = "uniminmax")
```
！！这里有一个隐秘的trend，就是有一些maxpop和medpop很高，但是min——pop极低的专辑，这说明有些专辑内部pop方差很大（虽然大部分不是这样）。


### Spotify Track

```{r}

my_data <- sptf_tk[, 4:16]
corr <- round(cor(my_data, use="complete.obs"), 1)
# Visualize
ggcorrplot(corr, p.mat = cor_pmat(my_data),
           hc.order = TRUE, type = "lower",
           color = c("#FC4E07", "white", "#00AFBB"),
           outline.col = "white", lab = TRUE)
```

```{r}

inst = ggplot(sptf_tk, aes(instrumentalness, popularity)) + 
  geom_point(size = 0.03, alpha = 0.9, colour = "grey") + 
  geom_smooth(colour = "darkgreen") +
  labs(x = "Instrumentalness", y = "Popularity") +
  ggtitle("Popularity vs Instrumentalness")

dance = ggplot(sptf_tk, aes(danceability, popularity)) + 
  geom_point(size = 0.03, alpha = 0.9, colour = "grey") + 
  geom_smooth(colour = "darkgreen") +
  labs(x = "Danceability", y = "Popularity") +
  ggtitle("Popularity vs Danceability")

multiplot(inst,dance ,cols = 2)
```



## Spotify VS Metacritic VS RYM

```{r}
spt_rym = ggplot(df, aes(RYM_Rating, max_pop)) + 
  geom_point(size = 0.03, alpha = 0.5,colour = "blue3") + 
  labs(x = "Album Score on RYM", y = "Spotify_Popularity(max in an album)") +
  geom_smooth(colour = "blue3") +
  ggtitle("Spotify Popularity VS RYM Rating")

spt_meta = ggplot(df, aes(Metacritic_Score, max_pop)) + 
  geom_point(size = 0.03, alpha = 0.5, colour = "purple2") + 
  labs(x = "Album Score on Metacritic", y = "Spotify_Popularity(max in an album)") +
  geom_smooth(colour = "purple2") +
  ggtitle("Spotify Popularity VS Metacritic Rating")

multiplot(spt_meta,spt_rym,cols = 2)
```
```{r}
ggplot(df, aes(Metacritic_Score, max_pop,colour = Fct_Release_Year)) + 
  geom_point(size = 0.03, alpha = 0.5) + 
  labs(x = "Album Score on Metacritic", y = "Spotify_Popularity(max in an album)") +
  geom_smooth(colour = "purple2") +
  facet_wrap(~Fct_Release_Year) +
  ggtitle("Spotify Popularity VS Metacritic Rating")
```

```{r}
ggplot(df, aes(RYM_Rating, max_pop,colour = Fct_Release_Year)) + 
  geom_point(size = 0.03, alpha = 0.5) + 
  labs(x = "Album Score on RYM", y = "Spotify_Popularity(max in an album)") +
  geom_smooth(colour = "blue3") +
  facet_wrap(~Fct_Release_Year) +
  ggtitle("Spotify Popularity VS RYM Rating")
```





```{r}

ggparcoord(df, columns = c(17,2,18,9,19), alpha=0.05,
           title = "Parallel coordinate plot for Album Popularity and Ratings",
           scale = "uniminmax")

```


```{r}
ggparcoord(df, columns = c(17,2,18,9,19), alpha=0.1,groupColumn= "Fct_Release_Year",
           title = "Parallel coordinate plot for Album Popularity and Ratings",
           scale = "uniminmax") + 
  theme(axis.text.x = element_text(face="bold", size=5, angle=18)) +
  facet_wrap(~Fct_Release_Year)
```

```{r}
colnames(df)
```



